---
title: "602-abgd"
author: "Mac Campbell"
date: "7/28/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)
```

```{r}
library(tidyverse)
library(ggtree)
library(phytools)
library(phangorn)
```

cytb.

(base) Macs-MacBook-Pro-2:602 mac$ grep ">" cytb.afas 
>MH603006.1 Catostomus sp. 'Wall Canyon'
>JX488812.1 Catostomus sp. 'Wall Canyon'
>JX488813.1 Catostomus sp. 'Wall Canyon'
>JX488814.1 Catostomus warnerensis
>KU697915.1 Catostomus warnerensis
>JX488815.1 Catostomus warnerensis 
>JX488785.1 Catostomus fumeiventris
>MH603022.1:1 Catostomus fumeiventris
>JX488784.1 Catostomus fumeiventris

in 602: ../temp/Abgd/abgd -a cytb.afas 
../temp/Abgd/abgd -a nd2.afas
>MH603026.1:1-1047 Catostomus sp.
>JX488882.1:1-1047 Catostomus sp.
>JX488883.1:1-1047 Catostomus sp.
>JX488884.1:1-1047 Catostomus warnerensis
>KU697943.1:1-1047 Catostomus warnerensis
>JX488885.1:1-1047 Catostomus warnerensis
>KU697962.1:1-1047 Chasmistes cujus
>JX488853.1:1-1047 Catostomus fumeiventris
>JX488854.1:1-1047 Catostomus fumeiventris
>MH603042.1:1-1047 Catostomus fumeiventris

~/Dropbox/bin/shortenNamesMac.pl nd2.afas > nd2-shortnames.afas
../temp/Abgd/abgd -a nd2-shortnames.afas 

../temp/Abgd/abgd -a nd2-renamed.afas 

~/Dropbox/bin/shortenNamesMac.pl nd2-Sac+Klam+Wall.txt > nd2-Sac+Klam+Wall.fas
mafft nd2-Sac+Klam+Wall.fas > nd2-Sac+Klam+Wall.afas
 ../temp/Abgd/abgd -a nd2-Sac+Klam+Wall.afas
 
```{r}
tree<-read.tree("outputs/602/nd2-renamed.part.1.tree")
tree<-midpoint.root(tree)
```

```{r}
ggtree(tree) +
  geom_tiplab() +
  geom_treescale()+
xlim(0,.1)

ggsave("outputs/602/nd2-abgd-tree.pdf")
ggsave("outputs/602/nd2-abgd-tree.jpg")
```
     
https://bioinfo.mnhn.fr/abi/public/asap/asapweb.html
ASAP

saved in outputs/602

begin spart;
Project_name = nd2-renamed.afas;
Date = 2022-02-21T10:59:46;
N_spartitions = 6 : nd2-renamed.afas_asap_1 / nd2-renamed.afas_asap_2 / nd2-renamed.afas_asap_3 / nd2-renamed.afas_asap_4 / nd2-renamed.afas_asap_5 / nd2-renamed.afas_asap_6;
N_individuals = 9 / 9 / 9 / 9 / 9 /  9;
N_subsets = 9 : ?,?,0.00e+00,2.14e-321,4.24e-314,6.92e-310,0.00e+00,0.00e+00,? / 8 : ?,?,?,?,?,?,?,? / 6 : 8.05e-01,?,?,?,?,? / 4 : 8.05e-01,8.33e-01,?,? / 3 : 8.05e-01,8.33e-01,9.20e-01 / 2 : 1.73e-01,9.20e-01 ;
[Generated by ASAP with Distance K80 Kimura ]
[Asap scores for the N_subset above are:]
[4.5 / 4.5 / 4.5 / 4.5 / 1.5 /  4.0 ]
[WARNING: The sample names below may have been changed to fit SPART specification (only alphanumeric characters and _ )]
Individual_assignment = 
MH603026_Catostomus_sp_ : 1 / 1 / 1 / 1 / 1 / 1
JX488882_Catostomus_sp_ : 2 / 1 / 1 / 1 / 1 / 1
JX488883_Catostomus_sp_ : 3 / 2 / 1 / 1 / 1 / 1
JX488884_Catostomus_warnerensis : 4 / 3 / 2 / 2 / 2 / 1
KU697943_Catostomus_warnerensis : 5 / 4 / 3 / 2 / 2 / 1
JX488885_Catostomus_warnerensis : 6 / 5 / 3 / 2 / 2 / 1
JX488853_Catostomus_fumeiventris : 7 / 6 / 4 / 3 / 3 / 2
JX488854_Catostomus_fumeiventris : 8 / 7 / 5 / 4 / 3 / 2
MH603042_Catostomus_fumeiventris : 9 / 8 / 6 / 4 / 3 / 2;
end;


Making a ml tree, or network?

```{r}
dna<-read.dna(file="outputs/602/nd2-renamed.afas", format="fasta")
```

```{r}
m<-dist.dna(dna, as.matrix = TRUE)
t<-nj(m)
plot(t)
```

```{r}
dat<-as.phyDat(dna)
set.seed(1)
bs <- bootstrap.phyDat(dat, FUN = function(x)nj(dist.hamming(x)), 
    bs=1000)
tree <- midpoint.root(nj(dist.hamming(dat)))
```


```{r}
btree <- plotBS(tree, bs, "phylogram", digits = 0)
add.scale.bar()
```

```{r}
pdf("outputs/602/nd2-tree.pdf", width=8, height=5)
btree <- plotBS(tree, bs, "phylogram", digits = 0)
add.scale.bar()
dev.off()
```
